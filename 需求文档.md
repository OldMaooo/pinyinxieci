# 看拼音写词 - 需求文档

## 项目概述

一个帮助小学生通过手写练习掌握生词的网页应用，实现**测试→校对→学习→测试**的自主学习闭环，无需家长参与。

---

## 一、核心功能需求

### 1.1 手写输入功能
- **输入方式**：
  - iPad手写笔输入（触摸屏）
  - 电脑鼠标输入
  - 支持绘制笔画，实时显示笔迹
- **技术要求**：
  - 使用Canvas或SVG绘制笔迹
  - 支持清除重写功能
  - 支持撤销/重做（可选，简化版本可不做）
  - 适配不同屏幕尺寸（响应式设计）

### 1.2 书写校验功能（核心难点）

**确认方案**：使用第三方手写识别API（百度、腾讯、讯飞等）
- 设置严格置信度阈值，只接受高置信度结果
- 实现快速，便于MVP版本快速上线

**书写快照功能**（重要）：
- 记录孩子书写的完整笔迹（Canvas图片快照）
- 错题展示时，同时显示：
  - 孩子写的字（快照）
  - 标准正确答案
  - 并排对比，直观看出差异
- 存储格式：Base64图片或Canvas数据URL

### 1.3 练习闭环流程

```
开始练习 → 显示拼音 → 手写输入 → 自动校验 
    ↓（错误）
错题记录 → 显示正确答案 → 学习模式 → 再次测试
    ↓（正确）
继续下一题 → 完成一轮 → 统计报告 → 错题复习
```

---

## 二、题库管理需求

### 2.1 PDF教材提取（优先级1）

**数据源**：
- 用户提供PDF格式的小学人教版语文教材
- 提取最后几页的写字表（生字表）

**功能要求**：
- 提供PDF解析工具/脚本
- 自动识别和提取写字表内容
- 提取生字、拼音、年级、学期、单元信息
- 导出为JSON格式，可直接导入系统
- 如果PDF格式不统一，提供手动修正界面

**提取工具方案**：
- Python脚本（PyPDF2/pdfplumber）解析PDF
- 识别表格结构
- 提取生字和分类信息
- 生成标准化数据格式

**数据结构**：
```json
{
  "grade": 1,
  "semester": "上",
  "unit": 1,
  "words": [
    {
      "word": "人",
      "pinyin": "rén",
      "strokes": 2
    }
  ]
}
```

### 2.2 手动输入题库（备选方案）

**功能要求**：
- 批量导入生词（支持Excel/CSV/纯文本）
- 单条手动添加
- 支持拼音自动标注（可选，可用拼音库）

**分类管理**：
- 导入后手动分类到相应年级和单元
- 支持批量移动分类
- 支持搜索和筛选
- 生词库逐渐积累，形成个人题库

**导入格式示例**：
```
人,一年级,上学期,第一单元
大,一年级,上学期,第一单元
...
```

### 2.3 题库存储结构

```json
{
  "wordBank": [
    {
      "id": "word_001",
      "word": "人",
      "pinyin": "rén",
      "grade": 1,
      "semester": "上",
      "unit": 1,
      "standardStrokes": [...], // 标准笔画轨迹数据
      "addedDate": "2024-01-01"
    }
  ]
}
```

---

## 三、错题本与复习系统

### 3.1 错题记录
- 自动记录写错的字
- 记录错误次数
- 记录首次错误时间
- 记录最近错误时间
- 记录错误类型（笔画顺序错误、结构错误、完全写错等，可选）

### 3.2 遗忘曲线复习（暂缓实现）
- ~~基于艾宾浩斯遗忘曲线算法~~（Phase 2实现）
- ~~推荐复习时间点~~（Phase 2实现）
- 当前版本：手动复习错题集即可

### 3.4 错题本功能
- 查看所有错题
- 按错误次数排序
- 按时间排序
- 一键清除已掌握的字（连续N次正确）
- 导出错题列表（供打印等用途）
- **错题展示**（核心功能）：
  - 显示孩子书写的快照（原字图片）
  - 显示标准正确答案（并排对比）
  - 直观看出书写差异和问题所在

---

## 四、练习模式与统计

### 4.1 练习设置
- **时间限制**：
  - 每个字最多给N秒（可配置，默认30秒）
  - 超过时间未完成算作不会，记录错题
  - 倒计时显示（可选）
- **题目数量**：
  - 可选择练习字数（10/20/50/全部等）
  - 可选择随机抽取或按顺序
- **练习范围**：
  - 指定年级和单元
  - 指定错题本
  - 混合模式（新词+错题）

### 4.2 实时反馈
- 书写正确：立即提示✓，自动进入下一题
- 书写错误：显示✗，显示正确答案，可选择：
  - 查看标准写法（动画演示，可选）
  - 重新尝试
  - 跳过（记录为错题）

### 4.3 学习模式（可选）
- 显示标准字的笔画顺序动画
- 显示标准字的笔顺示范
- 支持描红练习（显示灰色字，让孩子描）

### 4.4 练习统计

每轮练习结束后显示：

**统计指标**：
- 总题数
- 正确题数
- 错误题数
- 正确率（百分比）
- 总用时
- 平均每字用时
- 最快用时
- 最慢用时

**错题展示**：
- 列出本轮所有错字
- 显示每个错字的标准写法
- **并排对比**：孩子写的快照 vs 标准答案（直观对比）
- 显示错误原因（如果记录了）

**操作按钮**：
- **一键复习**：将所有错题重新组卷练习
- **逐个复习**：逐个显示错题，允许重新书写
- **查看全部**：以列表形式展示所有错题
- **继续练习**：返回练习选择页面

---

## 五、数据存储与导出导入

### 5.1 本地存储方案
- **主要存储**：使用浏览器LocalStorage或IndexedDB
- **数据结构**：
  ```json
  {
    "wordBank": [...],
    "practiceLogs": [...],
    "errorWords": [...],
    "settings": {...},
    "exportDate": "2024-01-01T00:00:00Z"
  }
  ```

### 5.2 导出功能
- 一键导出所有数据为JSON文件
- 包含：
  - 题库数据
  - 练习记录
  - 错题本
  - 用户设置
  - 统计数据

### 5.3 导入功能
- 选择JSON文件导入
- 导入前预览数据（题目数量、练习记录等）
- 支持合并模式：
  - 完全替换（清空当前数据）
  - 合并模式（合并题库，保留两边数据）
- 导入后验证数据完整性
- 显示导入结果统计

### 5.4 数据备份建议
- 定期提醒导出备份
- 支持自动备份到本地（可选）
- 数据加密（可选，简化版本可不做）

---

## 六、用户界面需求

### 6.1 跨端支持（响应式设计）
- **iPad支持**：横屏/竖屏，手写笔输入
- **电脑支持**：鼠标输入，大屏幕显示
- 使用响应式布局，自动适配不同屏幕尺寸
- 触摸和鼠标事件统一处理

### 6.2 界面布局
- **首页**：选择练习模式、查看统计、导入导出
- **练习页面**：
  - 拼音显示区（大字体）
  - 手写输入区（Canvas，居中，足够大）
  - 操作按钮（清除、提交、跳过）
  - 倒计时显示（可选）
- **结果页面**：统计数据、错题列表、操作按钮
- **错题本页面**：错题列表、复习提醒、筛选排序
- **题库管理页面**：导入、分类、搜索、编辑

### 6.3 交互体验
- 清晰的视觉反馈（正确✓、错误✗）
- 流畅的动画效果
- 简单直观的操作流程
- 适合孩子的配色和字体大小
- 避免过多干扰元素

---

## 七、技术实现建议

### 7.1 前端技术栈
- **基础**：HTML5 + CSS3 + JavaScript（原生或框架）
- **手写输入**：Canvas API 或 Fabric.js
- **数据存储**：LocalStorage / IndexedDB
- **UI框架**：Bootstrap（根据用户偏好）
- **拼音库**：使用现成的拼音标注库（如pinyin-pro）

### 7.2 手写识别方案
- **确认方案**：使用第三方API（百度、腾讯、讯飞等）
- 设置严格置信度阈值
- 快速实现MVP版本

### 7.3 PDF题库提取方案
- Python脚本解析PDF教材
- 提取写字表（最后几页）
- 识别表格结构，提取生字和分类信息
- 生成JSON格式数据，可直接导入系统
- 工具：PyPDF2 或 pdfplumber

### 7.4 项目结构建议
```
看拼音写词/
├── index.html          # 主页面
├── css/
│   └── styles.css      # 样式文件
├── js/
│   ├── main.js         # 主逻辑
│   ├── handwriting.js  # 手写输入处理
│   ├── recognition.js  # 识别校验逻辑
│   ├── wordbank.js     # 题库管理
│   ├── practice.js     # 练习逻辑
│   ├── statistics.js   # 统计功能
│   └── data.js         # 数据存储导出导入
├── data/
│   └── wordBank.json   # 默认题库（可选）
└── README.md
```

---

## 八、补充需求

### 8.1 学习激励（暂不实现）
- ~~积分系统~~（暂不实现）
- ~~连续正确奖励~~（暂不实现）
- ~~进度可视化~~（暂不实现）
- ~~每日练习目标~~（暂不实现）

### 8.2 家长功能（可选，简化版可不做）
- 查看孩子练习报告
- 设置练习参数（时间限制、题目数量等）
- 查看错题趋势分析

### 8.3 多用户支持（可选）
- 支持多个孩子账户
- 数据独立存储
- 快速切换账户

### 8.4 离线支持
- 纯前端实现，无需服务器
- 所有功能本地运行
- 导出导入支持多设备同步

### 8.5 数据统计与分析
- 学习曲线图表
- 错题分布分析
- 练习时长统计
- 掌握程度评估

---

## 九、开发优先级

### Phase 1: MVP（最小可行产品）
1. 基础手写输入（Canvas，支持iPad和电脑）
2. 第三方API识别校验（严格模式）
3. PDF题库提取工具
4. 手动导入题库
5. 基础练习流程
6. 错题记录（含书写快照）
7. 错题对比展示（快照 vs 标准答案）
8. 手动复习错题集
9. 本地存储
10. 导出导入
11. 练习统计

### Phase 2: 核心功能完善
1. 笔画顺序校验优化
2. 遗忘曲线复习系统
3. 详细统计报告
4. 学习模式（笔画演示）
5. 题库自动抓取优化

### Phase 3: 优化与扩展
1. 高级识别算法
2. 数据分析可视化
3. 多用户支持
4. 响应式优化

---

## 十、已确认方案

1. **识别方案**：✅ 使用第三方API（快速实现）
2. **题库来源**：✅ PDF教材，提取写字表
3. **功能范围**：✅ 不包含学习激励功能
4. **跨端支持**：✅ iPad和电脑跨端使用
5. **复习方式**：✅ 先手动复习错题集，遗忘曲线暂缓
6. **错题展示**：✅ 记录书写快照，并排对比
7. **技术栈**：✅ 原生JS + Bootstrap（跨端响应式）

---

## 十一、数据格式示例

### 11.1 完整数据导出格式
```json
{
  "version": "1.0",
  "exportDate": "2024-01-15T10:30:00Z",
  "wordBank": [
    {
      "id": "word_001",
      "word": "人",
      "pinyin": "rén",
      "grade": 1,
      "semester": "上",
      "unit": 1,
      "addedDate": "2024-01-01"
    }
  ],
  "practiceLogs": [
    {
      "id": "log_001",
      "date": "2024-01-15T09:00:00Z",
      "totalWords": 20,
      "correctCount": 18,
      "errorCount": 2,
      "totalTime": 600,
      "averageTime": 30,
      "errorWords": ["word_005", "word_012"]
    }
  ],
  "errorWords": [
    {
      "wordId": "word_005",
      "word": "大",
      "pinyin": "dà",
      "firstErrorDate": "2024-01-10T10:00:00Z",
      "lastErrorDate": "2024-01-15T09:30:00Z",
      "errorCount": 3,
      "handwritingSnapshots": [
        {
          "practiceId": "log_001",
          "snapshot": "data:image/png;base64,...", // 书写快照
          "date": "2024-01-15T09:30:00Z"
        }
      ]
    }
  ],
  "settings": {
    "timeLimitPerWord": 30,
    "defaultWordCount": 20,
    "recognitionThreshold": 0.85 // 识别置信度阈值（严格模式）
  }
}
```

---

## 十二、测试场景

### 12.1 功能测试
- [ ] 手写输入正常响应
- [ ] 识别校验准确性
- [ ] 题库导入导出
- [ ] 练习流程完整
- [ ] 错题记录准确
- [ ] 统计计算正确

### 12.2 兼容性测试
- [ ] iPad Safari浏览器
- [ ] iPad Chrome浏览器
- [ ] 电脑Chrome
- [ ] 电脑Firefox
- [ ] 电脑Safari

### 12.3 用户体验测试
- [ ] 界面清晰易用
- [ ] 操作流程顺畅
- [ ] 反馈及时明确
- [ ] 适合孩子使用

---

## 总结

本文档整理了项目的完整需求，包括核心功能、题库管理、错题复习、数据存储等各个方面。建议按照Phase 1的MVP版本开始开发，逐步完善功能。

**下一步行动**：
1. 确认需求文档，补充或修改
2. 确定技术方案（特别是识别方案）
3. 开始Phase 1开发

---

*文档版本：v1.0*  
*最后更新：2024-01-15*
