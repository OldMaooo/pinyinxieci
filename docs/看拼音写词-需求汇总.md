# 看拼音写词应用需求汇总

> 目的：为后续模型或开发者提供一份精炼、结构化的参考，快速理解“看拼音写词”应用的业务目标、核心流程与技术要点。

## 1. 项目概述
- **定位**：小学语文拼音写词练习工具，帮助孩子完成“拼音提示 → 手写输入 → 自动判定 → 错题复习”的闭环。
- **核心价值**：降低家长辅导成本，提升孩子自主练习效率，保留书写轨迹便于对比校对。
- **运行方式**：纯前端单页应用（SPA），所有数据存储在浏览器本地，可离线使用；通过第三方 API 完成手写识别。

## 2. 目标用户与使用场景
- **主要用户**：小学阶段学生；日常陪练的家长。
- **设备场景**：优先适配 iPad（手写笔）、触摸屏设备、PC + 鼠标输入。
- **使用流程**：
  1. 导入教材字词（PDF/JSON/手动录入）。
  2. 选择练习范围与题量，启动练习。
  3. 学生根据拼音用手写方式填写，系统自动识别与判定。
  4. 完成一轮练习后查看统计、错题详情并安排复习。

## 3. 核心流程（端到端）
1. **题库准备**
   - 通过 PDF 提取脚本或手动导入 JSON 文本，生成结构化的字词库。
   - 支持按年级、学期、单元分类；可混合自定义字词。
2. **练习设置**
   - 配置题目数量、时间限制、练习范围（含年级/单元、错题集）。
   - 可选择顺序或随机抽题。
3. **练习答题**
   - 展示拼音提示与手写输入面板（Canvas）。
   - 支持撤销、清空、倒计时；识别成功后自动跳题。
4. **结果判定**
   - 依据第三方手写识别 API 返回结果，结合置信度阈值决定正确/错误。
   - 错题保存书写快照（Base64）与标准答案用于对比。
5. **结果页与统计**
   - 展示本轮统计：正确数、错误数、正确率、用时等。
   - 支持从结果页直接发起“错题再练”。
6. **错题本复习**
   - 按轮次或汇总查看错题；展示手写快照与正确写法。
   - 支持管理模式批量标记、删除；提供错题专项练习入口。
7. **数据导出/导入**
   - 所有数据（题库、错题、练习记录、设置）均可导出为 JSON。
   - 导入时可选择覆盖或合并，具备预览校验能力。

## 4. 功能模块拆解
| 模块 | 关键能力 | 备注 |
| --- | --- | --- |
| 练习设置 `practice.js` | 题量、时间、范围配置；启动练习 | 按年级/单元/错题筛选；支持默认值与提示 |
| 手写输入 `handwriting.js` | Canvas 涂写、撤销、重写、快照导出 | 支持触摸与鼠标；记录笔迹数组用于回放（可选） |
| 识别判定 `recognition.js` | 对接百度手写识别 API；阈值判定 | 需配置 appKey/secret；识别失败兜底方案 |
| 练习流程 `practice.js` | 抽题、计时、识别、跳题、记录错题 | 题目抽取策略、倒计时 UI、跳过逻辑 |
| 错题本 `errorbook.js` | 错题展示、快照对比、批量管理、再练 | 管理模式需双重确认；支持分组排序 |
| 数据存储 `storage.js` | localStorage 持久化；导入导出 | 键前缀隔离；合并策略、数据校验 |
| 题库管理 `wordbank.js` | 导入解析、分类、搜索、编辑 | PDF 数据预处理脚本位于 `scripts/` 目录 |
| 统计模块 `statistics.js` | 结果页统计、图表预留 | 现版本以数据面板为主，图表后续扩展 |
| 调试模块 `debug.js` | 调试信息开关、日志面板 | 调试模式下的练习数据与正式数据隔离 |

## 5. 数据模型（核心键）
- `wordBank`: `[ { id, word, pinyin, grade, semester, unit, addedDate, … } ]`
- `practiceLogs`: `[ { id, date, totalWords, correctCount, errorCount, totalTime, averageTime, errorWords: [wordId], … } ]`
- `errorWords`: `[ { wordId, word, pinyin, errorCount, firstErrorDate, lastErrorDate, handwritingSnapshots: [ { practiceId, snapshot, date } ], … } ]`
- `settings`: `{ timeLimitPerWord, defaultWordCount, recognitionThreshold, … }`
- 导出文件统一包含 `version` 与 `exportDate` 元信息。

## 6. 手写识别与 API 规范
- **供应商**：百度手写识别 API（可扩展腾讯、讯飞）。
- **调用方式**：通过 `api/baidu-proxy.js`（Vercel 无服务器函数）代理，避免暴露密钥。
- **关键配置**：`js/config.js` 储存识别参数与阈值；支持在调试模式下切换。
- **超时/失败兜底**：
  - HTTP 超时或置信度低时，提示“未识别成功”，可重写或跳过。
  - 调试模式记录 API 响应，便于排查。

## 7. UI / UX 要点
- **布局**：多页卡片式布局，导航栏切换（练习、错题本、题库管理、统计）。
- **视觉**：Bootstrap 5 + 自定义主题；浅色/深色模式；儿童友好配色。
- **交互**：
  - 练习面板突出拼音与书写区。
  - 结果页/错题页加强视觉对比（正确 vs 错误）。
  - 管理模式设有提示/确认，避免误操作。
- **可访问性**：保证触控目标尺寸、响应式布局、键盘可操作性（基础）。

## 8. 调试与开发支持
- **调试模式**：
  - 通过 UI 开关启用；显示额外日志、解析信息。
  - 调试状态下产生的练习/错题记录不会污染正式数据。
- **脚本工具**：
  - `scripts/extract_pdf.py`：PDF 写字表解析。
  - `scripts/proxy-server.js`：本地 API 代理。
- **版本管理**：`js/version.js` 或页面角落展示当前版本号，改动后需更新。

## 9. 后续扩展（已规划但未全部落地）
- 遗忘曲线算法、复习提醒。
- 更细粒度的错误类型标注。
- 多用户/多端同步与云备份。
- 共享组件库，与其它学习应用统一界面与交互。
- 更丰富的统计可视化与学习报告。

## 10. 交付要求与注意事项
- 保持纯前端部署（可托管在 GitHub Pages）。
- 所有配置、密钥需通过代理层或环境变量处理，避免硬编码暴露。
- 重点关注识别准确性与错题快照保存质量。
- 对外提供 `README` 与本需求汇总，便于快速上手与二次开发。

---

**最后更新**：2025-11-10
